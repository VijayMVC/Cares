@model IstMvcFramework.ViewModels.Employees.EmployeeViewModel
@using PagedList.Mvc;

@Html.AntiForgeryToken()


@helper SortLink(string name, int id)
{
    @Ajax.ActionLink(name, "Index", new { Sortby = id, isasc = (id != @Model.EmployeeSearchRequest.SortBy || (!@Model.EmployeeSearchRequest.IsAsc)), @Model.EmployeeSearchRequest.DepartmentId, @Model.EmployeeSearchRequest.PageSize, @Model.EmployeeSearchRequest.SearchString },
        new AjaxOptions

        {
            UpdateTargetId = "gridContent", // <-- DOM element ID to update

            InsertionMode = InsertionMode.Replace, // <-- Replace the content of DOM element

            HttpMethod = "GET", // <-- HTTP method

        })
    if (id == @Model.EmployeeSearchRequest.SortBy)
    {
        <span class="arrow @(@Model.EmployeeSearchRequest.IsAsc ? "up" : "down")"></span>
    }

}


<div id="gridContent">
    <input type="hidden" id="SortBy" value="@Model.EmployeeSearchRequest.SortBy" />
    <input type="hidden" id="DepartmentId" value="@Model.EmployeeSearchRequest.DepartmentId" />
    <input type="hidden" id="IsAsc" value="@Model.EmployeeSearchRequest.IsAsc" />
    <input type="hidden" id="PageSize" value="@Model.EmployeeSearchRequest.PageSize" />
    <input type="hidden" id="PageCount" value="@Model.EmployeeList.PageCount" />
    <input type="hidden" id="DeleteItemId" value="" />
    <input type="hidden" id="CurrentPageNumber" value=@Model.EmployeeSearchRequest.PageNo />
    <input type="hidden" id="SearchText" value=@Model.EmployeeSearchRequest.SearchString />
    <table class="grid-content-table">
        <tr>
            <th> @SortLink(@IstMvcFramework.Resources.Employees.Employee.Name, 1) </th>
            <th> @IstMvcFramework.Resources.Employees.Employee.Bio</th>
            <th> @SortLink(@IstMvcFramework.Resources.Employees.Employee.DateOfBirth, 2)</th>
            <th> @SortLink(@IstMvcFramework.Resources.Employees.Employee.DepartmentName, 3)</th>

            <th class="editdelete">@IstMvcFramework.Resources.Shared.Common.EditDelete</th>
        </tr>


        @foreach (var item in Model.EmployeeList)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Name)
                </td>
                <td>
                    @Html.ActionLink(item.Bio, "Delete", new { id = item.Id })

                </td>
                <td>

                    @Html.DisplayFor(modelItem => item.DateOfBirth)
                </td>
                <td>

                    @Html.DisplayFor(modelItem => item.Department.Name)
                </td>
                <td class="editdelete">

                    @Html.ActionLink(" ", "Create", new { id = item.Id }, new { @class = "edit" }) |
                    <a class="delete" href="#" data-delete-id="@item.Id"></a>

                    @*<a class="delete" href="@Url.Action("Delete", new {id = item.Id})"></a>*@

                </td>
            </tr>
        }
        <tfoot id="footer">
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </tfoot>

    </table>
    <br />
    <div id="myPager">
        <table id="pager-table">
            <tr>
                <td style="width: 15%">@IstMvcFramework.Resources.Shared.Common.TotalRecords @Model.TotalNoOfRec</td>
                <td style="width: 67%">
                    @Html.PagedListPager(Model.EmployeeList, PageNo => Url.Action("Index", new { PageNo, @Model.EmployeeSearchRequest.SortBy, @Model.EmployeeSearchRequest.IsAsc, @Model.EmployeeSearchRequest.DepartmentId, @Model.EmployeeSearchRequest.PageSize, @Model.EmployeeSearchRequest.SearchString }),
                        PagedListRenderOptions.EnableUnobtrusiveAjaxReplacing(new AjaxOptions() { HttpMethod = "GET", UpdateTargetId = "gridContent" })
                        )
                    @*@Html.PagedListPager(Model.ProductList, PageNo => Url.Action("Index",
                        new { PageNo, @Model.ProductSearchRequest.SortBy, @Model.ProductSearchRequest.IsAsc, @Model.ProductSearchRequest.CategoryId }))*@
                </td>
                <td>
                    @Html.DropDownListFor(m => m.EmployeeSearchRequest.PageSize, new List<SelectListItem>
                                                                                {
                                                                                    new SelectListItem{Text="5",Value="5"},
                                                                                    new SelectListItem{Text="10",Value="10"},
                                                                                    new SelectListItem{Text="15",Value="15"},
                                                                                    new SelectListItem{Text="20",Value="20"}
                    },
                      new { @class = "dropdown" })


                </td>
                <td>


                    <p>
                        @IstMvcFramework.Resources.Shared.Common.Page @Html.TextBox("PageNo", @Model.EmployeeSearchRequest.PageNo, null, new { style = "width:40px", id = "UserPageInput" })\@Model.EmployeeList.PageCount
                    </p>


                </td>
            </tr>
        </table>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            var ist = window.ist;
            ist.product.viewModel.initialize();
        });
    </script>
</div>


